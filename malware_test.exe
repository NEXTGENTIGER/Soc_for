import os

# 1. Création du dossier input et du faux fichier "malware"
os.makedirs("/home/user/RR/input", exist_ok=True)
malware_path = "/home/user/RR/input/malware_test.exe"

malware_content = """MZ
SUSPICIOUS_PATTERN_1
SUSPICIOUS_PATTERN_2
MALWARE_TEST_STRING
EVIL_FUNCTION
SYSTEM_CALL
NETWORK_ACCESS
ENCRYPTED_DATA
SHELL_CODE
cmd.exe
powershell
curl
192.168.0.66
PE
.exe
"""

with open(malware_path, "w") as f:
    f.write(malware_content)
print(f"Fichier malware simulé créé: {malware_path}")

# 2. Création du dossier rules et d'une règle YARA de test
yara_dir = "/home/user/RR/rules"
os.makedirs(yara_dir, exist_ok=True)

rule_content = """
rule SimulatedMalware
{
    meta:
        description = "Règle de détection de malware simulé"
        author = "ChatGPT"
        date = "2025-06-14"

    strings:
        $mz = "MZ"
        $pattern1 = "SUSPICIOUS_PATTERN_1"
        $malware = "MALWARE_TEST_STRING"
        $network = "NETWORK_ACCESS"
        $shellcode = "SHELL_CODE"
        $cmd = "cmd.exe"
        $ip = /192\\.168\\.0\\.66/
        $pe = "PE"
        $exe = ".exe"
    condition:
        3 of them
}
"""

rule_path = os.path.join(yara_dir, "simulated_malware.yar")
with open(rule_path, "w") as r:
    r.write(rule_content)

print(f"Règle YARA créée: {rule_path}")


MZ
PE
cmd.exe
powershell
wget
curl
download
192.168.1.1
svchost.exe
explorer.exe
system32
HKEY_LOCAL_MACHINE
HKEY_CURRENT_USER
RunOnce
http://malicious.com
https://evil.com
ftp://bad.com
copy
move
delete
net user
net group
net localgroup
AES
RSA
encrypt 
