rule Suspicious_Executable {
    meta:
        description = "Détecte les fichiers exécutables suspects"
        severity = "HIGH"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $mz = "MZ"
        $pe = "PE"
        $exe = ".exe"
    condition:
        $mz at 0 and $pe and $exe
}

rule Malicious_Shellcode {
    meta:
        description = "Détecte les shellcodes malveillants"
        severity = "HIGH"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $shellcode1 = { 90 90 90 90 90 90 90 90 }  // NOP sled
        $shellcode2 = { 68 ?? ?? ?? ?? C3 }        // PUSH + RET
        $shellcode3 = { E8 ?? ?? ?? ?? }           // CALL
        $shellcode4 = { FF D0 }                     // CALL EAX
    condition:
        2 of them
}

rule Suspicious_Strings {
    meta:
        description = "Détecte les chaînes de caractères suspectes"
        severity = "MEDIUM"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $cmd = "cmd.exe" nocase
        $powershell = "powershell" nocase
        $wget = "wget" nocase
        $curl = "curl" nocase
        $download = "download" nocase
        $http = "http://" nocase
        $https = "https://" nocase
        $ftp = "ftp://" nocase
    condition:
        3 of them
}

rule Suspicious_IP_Address {
    meta:
        description = "Détecte les adresses IP suspectes"
        severity = "MEDIUM"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $ip = /[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/
    condition:
        $ip
}

rule Suspicious_Process {
    meta:
        description = "Détecte les noms de processus suspects"
        severity = "HIGH"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $process1 = "svchost.exe" nocase
        $process2 = "explorer.exe" nocase
        $process3 = "system32" nocase
        $process4 = "rundll32.exe" nocase
        $process5 = "regsvr32.exe" nocase
    condition:
        2 of them
}

rule Suspicious_Registry {
    meta:
        description = "Détecte les modifications de registre suspectes"
        severity = "HIGH"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $reg1 = "HKEY_LOCAL_MACHINE" nocase
        $reg2 = "HKEY_CURRENT_USER" nocase
        $reg3 = "RunOnce" nocase
        $reg4 = "RunServices" nocase
        $reg5 = "Startup" nocase
    condition:
        2 of them
}

rule Suspicious_Network {
    meta:
        description = "Détecte les activités réseau suspectes"
        severity = "MEDIUM"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $net1 = "http://" nocase
        $net2 = "https://" nocase
        $net3 = "ftp://" nocase
        $net4 = "smtp://" nocase
        $net5 = "irc://" nocase
    condition:
        2 of them
}

rule Suspicious_File_Operations {
    meta:
        description = "Détecte les opérations de fichiers suspectes"
        severity = "MEDIUM"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $file1 = "copy" nocase
        $file2 = "move" nocase
        $file3 = "delete" nocase
        $file4 = "rename" nocase
        $file5 = "create" nocase
    condition:
        2 of them
}

rule Suspicious_System_Commands {
    meta:
        description = "Détecte les commandes système suspectes"
        severity = "HIGH"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $cmd1 = "net user" nocase
        $cmd2 = "net group" nocase
        $cmd3 = "net localgroup" nocase
        $cmd4 = "net share" nocase
        $cmd5 = "net session" nocase
    condition:
        2 of them
}

rule Suspicious_Encryption {
    meta:
        description = "Détecte les opérations de chiffrement suspectes"
        severity = "HIGH"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $enc1 = "AES" nocase
        $enc2 = "RSA" nocase
        $enc3 = "encrypt" nocase
        $enc4 = "decrypt" nocase
        $enc5 = "crypt" nocase
    condition:
        2 of them
}

rule Suspicious_Anti_Analysis {
    meta:
        description = "Détecte les techniques anti-analyse"
        severity = "HIGH"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $anti1 = "virtualbox" nocase
        $anti2 = "vmware" nocase
        $anti3 = "wireshark" nocase
        $anti4 = "debugger" nocase
        $anti5 = "sandbox" nocase
    condition:
        2 of them
}

rule Suspicious_Persistence {
    meta:
        description = "Détecte les mécanismes de persistance"
        severity = "HIGH"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $pers1 = "startup" nocase
        $pers2 = "autostart" nocase
        $pers3 = "scheduled" nocase
        $pers4 = "task" nocase
        $pers5 = "service" nocase
    condition:
        2 of them
}

rule Suspicious_Privilege_Escalation {
    meta:
        description = "Détecte les tentatives d'élévation de privilèges"
        severity = "HIGH"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $priv1 = "admin" nocase
        $priv2 = "administrator" nocase
        $priv3 = "system" nocase
        $priv4 = "root" nocase
        $priv5 = "sudo" nocase
    condition:
        2 of them
}

rule Suspicious_Data_Exfiltration {
    meta:
        description = "Détecte les tentatives d'exfiltration de données"
        severity = "HIGH"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $exfil1 = "upload" nocase
        $exfil2 = "download" nocase
        $exfil3 = "send" nocase
        $exfil4 = "receive" nocase
        $exfil5 = "transfer" nocase
    condition:
        2 of them
}

rule Suspicious_Command_Execution {
    meta:
        description = "Détecte les exécutions de commandes suspectes"
        severity = "HIGH"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $exec1 = "exec" nocase
        $exec2 = "execute" nocase
        $exec3 = "run" nocase
        $exec4 = "launch" nocase
        $exec5 = "start" nocase
    condition:
        2 of them
}

rule Suspicious_Network_Protocols {
    meta:
        description = "Détecte les protocoles réseau suspects"
        severity = "MEDIUM"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $proto1 = "tcp" nocase
        $proto2 = "udp" nocase
        $proto3 = "icmp" nocase
        $proto4 = "dns" nocase
        $proto5 = "http" nocase
    condition:
        2 of them
}

rule Suspicious_File_Types {
    meta:
        description = "Détecte les types de fichiers suspects"
        severity = "MEDIUM"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $type1 = ".exe" nocase
        $type2 = ".dll" nocase
        $type3 = ".bat" nocase
        $type4 = ".vbs" nocase
        $type5 = ".ps1" nocase
    condition:
        2 of them
}

rule Suspicious_System_Modification {
    meta:
        description = "Détecte les modifications système suspectes"
        severity = "HIGH"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $mod1 = "modify" nocase
        $mod2 = "change" nocase
        $mod3 = "alter" nocase
        $mod4 = "update" nocase
        $mod5 = "replace" nocase
    condition:
        2 of them
}

rule Suspicious_Process_Injection {
    meta:
        description = "Détecte les injections de processus"
        severity = "HIGH"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $inj1 = "inject" nocase
        $inj2 = "injection" nocase
        $inj3 = "hook" nocase
        $inj4 = "hooking" nocase
        $inj5 = "patch" nocase
    condition:
        2 of them
}

rule Suspicious_Network_Connection {
    meta:
        description = "Détecte les connexions réseau suspectes"
        severity = "MEDIUM"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $conn1 = "connect" nocase
        $conn2 = "connection" nocase
        $conn3 = "socket" nocase
        $conn4 = "port" nocase
        $conn5 = "listen" nocase
    condition:
        2 of them
}

rule Suspicious_System_Information {
    meta:
        description = "Détecte la collecte d'informations système"
        severity = "MEDIUM"
        author = "Forensic Analyzer"
        date = "2025-06-14"
    strings:
        $info1 = "systeminfo" nocase
        $info2 = "whoami" nocase
        $info3 = "ipconfig" nocase
        $info4 = "netstat" nocase
        $info5 = "tasklist" nocase
    condition:
        2 of them
} 